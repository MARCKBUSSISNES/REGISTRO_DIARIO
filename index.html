<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control de Ventas Diarias - Empresa</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f4f6f8;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
    }
    .container {
        background-color: #fff;
        padding: 30px;
        margin: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        width: 90%;
        max-width: 900px;
    }
    h1 {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 20px;
    }
    #login, #registroVentas {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    input, button {
        padding: 10px;
        font-size: 16px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }
    button {
        cursor: pointer;
        transition: 0.3s;
    }
    #login button {
        background-color: #2c3e50;
        color: white;
        border: none;
    }
    #login button:hover { background-color: #34495e; }
    #registroVentas button {
        background-color: #27ae60;
        color: white;
        border: none;
    }
    #registroVentas button:hover { background-color: #2ecc71; }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        text-align: left;
    }
    th {
        background-color: #2c3e50;
        color: white;
    }
    tr:nth-child(even) { background-color: #f4f6f8; }
    .total {
        font-weight: bold;
        margin-top: 10px;
        color: #2c3e50;
        text-align: right;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Control de Ventas Diarias</h1>

    <!-- Login -->
    <div id="login">
        <input type="password" id="password" placeholder="Ingrese el c칩digo de acceso">
        <button onclick="verificarPassword()">Ingresar</button>
        <p id="loginError" style="color:red; display:none;">C칩digo incorrecto.</p>
    </div>

    <!-- Registro de ventas -->
    <div id="registroVentas" style="display:none;">
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <input type="date" id="fecha" style="flex:1;">
            <input type="number" id="efectivo" placeholder="Ventas en efectivo" min="0" style="flex:1;">
            <input type="number" id="tarjeta" placeholder="Ventas con tarjeta" min="0" style="flex:1;">
            <button onclick="agregarVenta()" style="flex:1;">Agregar registro</button>
        </div>

        <table id="tablaVentas">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Efectivo (Q)</th>
                    <th>Tarjeta (Q)</th>
                    <th>Total (Q)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <p class="total">Total acumulado: Q<span id="totalAcumulado">0.00</span></p>

        <canvas id="graficaVentas" style="margin-top:30px;"></canvas>

        <button onclick="descargarCSV()" style="margin-top:20px;">Descargar CSV</button>
    </div>
</div>

<script>
    const passwordCorrecto = "22782522";
    const ventas = [];

    function verificarPassword() {
        const pass = document.getElementById('password').value;
        if(pass === passwordCorrecto) {
            document.getElementById('login').style.display = 'none';
            document.getElementById('registroVentas').style.display = 'flex';
        } else {
            document.getElementById('loginError').style.display = 'block';
        }
    }

    function agregarVenta() {
        const fecha = document.getElementById('fecha').value;
        const efectivo = parseFloat(document.getElementById('efectivo').value);
        const tarjeta = parseFloat(document.getElementById('tarjeta').value);

        if(!fecha || isNaN(efectivo) || isNaN(tarjeta)) {
            alert("Ingrese datos v치lidos.");
            return;
        }

        const total = efectivo + tarjeta;
        ventas.push({fecha, efectivo, tarjeta, total});
        actualizarTabla();
        actualizarGrafica();
        limpiarCampos();
    }

    function actualizarTabla() {
        const tbody = document.getElementById('tablaVentas').querySelector('tbody');
        tbody.innerHTML = "";

        let acumulado = 0;
        ventas.forEach(v => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${v.fecha}</td>
                            <td>Q${v.efectivo.toFixed(2)}</td>
                            <td>Q${v.tarjeta.toFixed(2)}</td>
                            <td>Q${v.total.toFixed(2)}</td>`;
            tbody.appendChild(tr);
            acumulado += v.total;
        });

        document.getElementById('totalAcumulado').innerText = acumulado.toFixed(2);
    }

    function limpiarCampos() {
        document.getElementById('fecha').value = "";
        document.getElementById('efectivo').value = "";
        document.getElementById('tarjeta').value = "";
    }

    // Descargar CSV
    function descargarCSV() {
        let csv = "Fecha,Efectivo,Tarjeta,Total\n";
        ventas.forEach(v => {
            csv += `${v.fecha},${v.efectivo.toFixed(2)},${v.tarjeta.toFixed(2)},${v.total.toFixed(2)}\n`;
        });

        const blob = new Blob([csv], {type: 'text/csv'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ventas_diarias.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    // Gr치fica
    let grafica;
    function actualizarGrafica() {
        const ctx = document.getElementById('graficaVentas').getContext('2d');
        const etiquetas = ventas.map(v => v.fecha);
        const totales = ventas.map(v => v.total);

        if(grafica) grafica.destroy();

        grafica = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: etiquetas,
                datasets: [{
                    label: 'Total diario (Q)',
                    data: totales,
                    backgroundColor: '#27ae60'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Ventas Diarias' }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
    }
</script>

</body>
</html>
